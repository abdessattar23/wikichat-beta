<!DOCTYPE html>
<html lang="en" onload="testCookie()">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>LOGIN | WikiChat</title>
    <link href="https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css" rel="stylesheet">
    <!-- Varela Round -->
    <link href="https://fonts.googleapis.com/css2?family=Varela+Round&display=swap" rel="stylesheet">
    <!-- CSS File -->
    <link rel="stylesheet" href="index.css">
    <link rel="shortcut icon" href="img/Logo.png" type="image/png">
    <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-database.js"></script>


</head>

<body>

    <div class="login-box">

        <h2>Welcome back</h2>
        <p>Enter your details</p>

        <form>
            <div class="form-group">
                <label for="username">
                    Username
                </label>
                <i class="bx bxs-user"></i>
                <input type="text" id="username" placeholder="Your username" required><br/>
                <select id="type" required>
                   <option value='leaker'>Leaker</option>
                   <option value='reader'>Reader</option>
                </select>
            </div>

            <input type="button" value="Log In Or Sign Up" onclick="login();">
            <code>Speak, leak, no retreat. Wikichat keeps you discreet.</code>
            <pre class="tut">watch our tutorial <a href="/tutorial">Here</a></pre>



        </form>

    </div>
    <script>
    function setCookie(cname, cvalue,) {
  document.cookie = cname + "=" + cvalue;
}
    function getCookie(cname) {
  let name = cname + "=";
  let ca = document.cookie.split(';');
  for(let i = 0; i < ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}
function Cookie(name) {
    var dc = document.cookie;
    var prefix = name + "=";
    var begin = dc.indexOf("; " + prefix);
    if (begin == -1) {
        begin = dc.indexOf(prefix);
        if (begin != 0) return null;
    }
    else
    {
        begin += 2;
        var end = document.cookie.indexOf(";", begin);
        if (end == -1) {
        end = dc.length;
        }
    }
    // because unescape has been deprecated, replaced with decodeURI
    //return unescape(dc.substring(begin + prefix.length, end));
    return decodeURI(dc.substring(begin + prefix.length, end));
}

function testCookie(){
    var ucookie = Cookie("username");
    var tcookie = Cookie("type");

    if (ucookie == null || tcookie == null) {

    }
    else {
        document.location = "message.html";
    }
}
// Login to the chat app
function login() {
  var type = document.getElementById("type").value;
  alert(type);
  var username = document.getElementById("username").value.trim();
  if (username != "") {
    setCookie("username", username);
      setCookie("type", type);
     document.location="message.html";
  }
}

    </script>
</body>

</html>